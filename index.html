<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<script type="text/javascript" src="http://dev.jtsage.com/cdn/spinbox/latest/jqm-spinbox.min.js"></script>
<script>
var textarray = {};

$( document ).ready(function() {
	$(document).on('click', '.delete', fdeleteitem);
	$(document).on('click', '.bought', fbought);
	var q = localStorage.getItem("previousList");
	if (q!=null) textarray = JSON.parse(q);
	savechoice()
	})
	

function fadditem(){
	text = $("#itemname").val();
	$("#itemname").val(text);
	var quantity = $("#spin").val();
	if(text === null || text === "" )
	{
	}
	else
	{
	if (quantity === null || quantity === "0" )
	{
	}
	else{
	savechoice();

	$("#itemname").val('');
	$("#spin").val('0');
	savechoice()
	}
	}
}
function savechoice(){
	vegetable= $("#itemname").val();
	quantitychosen= $("#spin").val();

	$("#shoppingList").empty();
	textarray[vegetable]= quantitychosen;
	localStorage.setItem("previousList",JSON.stringify(textarray));
	for (var key in textarray) {
     
	vegData = key + ":" +  textarray[key];
	$('<li>').append('<a href="#">' + '<input type="checkbox" class="bought" />'+ vegData + '<button class="delete" title="Delete item">Delete</button>'+ '</a>').appendTo('#shoppinglist');
	}
	$("#shoppingList").listview('refresh');
}	
function fdeleteitem(){
	
	$(this).parent().remove();
	localStorage.removeItem(this);
	savechoice();
}
function fbought(){
	if ($(this).parent().css('textDecoration') === 'line-through')
	{
		$(this).parent().css('textDecoration', 'none');
		$(this).parent().css('opacity', '1');
	}
	else
	{
	$(this).parent().css('textDecoration', 'line-through');
	$(this).parent().css('opacity', '0.5');
	}
}



</script>


  <style>
  li{
  list-style-type: none;
  font-size: 25px;
  border-bottom: 1px solid #eee;
  }
  input[type=checkbox] {
  margin-right: 10px;
  }
  .delete{
  float:right;
  background-color: #f44336;
  color: #e7e7e7;
  width: 99px;
  height: 25px;
  font-size: 16px;
  
  }
  </style>

<div data-role="page" id="shoppinglistpage">
  <div data-role="main" class="ui-content">
  <title> Shoppinglist </title>
  <div data-role="header">
    <h1>Shoppinglist</h1>
  </div>
	<div>Item name: <input type = "text" id = "itemname" placeholder = "Enter the name of item">
	     <div class="ui-field-contain">
       <label for="spin">Amount</label>
       <input type="text" data-role="spinbox" name="spin" id="spin" value="0" min="0" max="10" />
      </div>
	<a onclick="fadditem(this)" ; class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-plus ui-btn-icon-right" title= "Add item">Add</a>
	</div>
	<div><h2>Items saved</h2>
	<ul id = "shoppinglist">
	</ul>
	</div>
  </div>
  </div>


</body>
</html>